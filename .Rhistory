speciesPCAvalues$Binomial4<-ifelse(grepl("Vanellus", speciesPCAvalues$Binomial),as.character(speciesPCAvalues$Binomial),speciesPCAvalues$Binomial4)
speciesPCAvalues$Binomial4p5<-ifelse(grepl("Stercorarius_antarcticus", speciesPCAvalues$Binomial),as.character(speciesPCAvalues$Binomial),"")
speciesPCAvalues$Binomial4p5<-ifelse(grepl("Larus_dominicanus", speciesPCAvalues$Binomial),as.character(speciesPCAvalues$Binomial),speciesPCAvalues$Binomial4p5)
speciesPCAvalues$Binomial5<-ifelse(grepl("Alca", speciesPCAvalues$Binomial),as.character(speciesPCAvalues$Binomial),"")
speciesPCAvalues$Binomial5<-ifelse(grepl("Fratercula", speciesPCAvalues$Binomial),as.character(speciesPCAvalues$Binomial),speciesPCAvalues$Binomial5)
speciesPCAvalues$Binomial5<-ifelse(grepl("Cepphus", speciesPCAvalues$Binomial),as.character(speciesPCAvalues$Binomial),speciesPCAvalues$Binomial5)
speciesPCAvalues$Order3<-ifelse(grepl("Anseriformes", speciesPCAvalues$Order),as.character(speciesPCAvalues$Order),"")
speciesPCAvalues$divescore<-as.factor(speciesPCAvalues$divescore)
######################plot PC1 vs PC2 coloured by different factors
###############BIPLOT BASIC FUNCTION####################
qualitative_hcl(5, palette = "Dark 3")
runPCAplot<-function(group, p1,p2,n1,n2){
scattercat1<-ggplot(speciesPCAvalues, aes_string(x = p1, y = p2, label = "Binomial")) +
theme_classic()+
xlab(label = paste0("p",as.character(p1),"(",
as.character(signif(d$percentexplained[n1], digits = 3)),
"%)"))+
ylab(label = paste0("p",as.character(p2),"(",
as.character(signif(d$percentexplained[n2], digits = 3)),
"%)"))+
#theme(legend.position = "none")+
geom_encircle(data = speciesPCAvalues[which(is.na(speciesPCAvalues$Order2)),],
aes_string(),s_shape=1, expand=0, alpha = 0, col = "black")+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$Order=="Charadriiformes",],
aes_string(),s_shape=1, expand=0, fill = "#E16A86", alpha = 1, col = "black")+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$Order=="Procellariiformes",],
aes_string(),s_shape=1, expand=0, fill = "#00AA5A", alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$Order=="Suliformes",],
aes_string(),s_shape=1, expand=0, fill = "#B675E0", alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$Order=="Sphenisciformes",],
aes_string(),s_shape=1, expand=0, fill = "#AA9000", alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$Order=="Anseriformes",],
aes_string(),s_shape=1, expand=0, fill = "#00A6CA",alpha = 1)+
geom_encircle(aes_string(fill = group),s_shape=1, expand=0, color = "black", alpha = 0.5)+#s_shape = 1 and expan = 0 are convex hull
geom_point(aes_string(color = group), shape = 21, size = 3, color = "black")+
#scale_color_manual(values = alpha(c("black","black","black","black","black","black",0.2))
geom_point(aes_string(fill = group), size = 3, shape = 21, col = "black")+
scale_color_manual(values = c("#00AA5A","#E16A86","#AA9000", "#B675E0", "#00A6CA"), na.value = "white")+
theme(legend.position = "none")
}
runPCAplot("Order2","PC1","PC2",1,2)
#set up color palette
mypal <- colorRampPalette(brewer.pal(6, "Blues"))
qualitative_hcl(5, palette = "Dark 3")
#plot by orders
speciesPCAvalues$Order2 <- fct_explicit_na(as.factor(speciesPCAvalues$Order2))
speciesPCAvalues$Order2 <-relevel(speciesPCAvalues$Order2,ref = "(Missing)")
speciesPCAvalues$Order2 <-factor(speciesPCAvalues$Order2,levels = c("(Missing)"  ,    "Procellariiformes", "Charadriiformes" ,
"Sphenisciformes"  , "Suliformes", "Anseriformes" ))
order<-runPCAplot("Order2","PC1","PC2",1,2) +
geom_point(aes(fill = Order2), size = 3, shape = 21, col = "black")+
scale_fill_manual(values = c("white","#00AA5A","#E16A86","#AA9000", "#B675E0", "#00A6CA"))+
theme(legend.position = "none")+
theme(legend.position = "right")+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$Order=="Anseriformes",],
aes_string(),s_shape=1, expand=0, fill = "#00AA5A",alpha = 0.5)+
geom_text_repel(aes(label = Binomial5),
nudge_y = 30 - speciesPCAvalues$PC2)+
geom_text_repel(aes(label = Binomial4),
nudge_y = 30 - speciesPCAvalues$PC2)
order
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# The palette with black:
cbbPalette <- c(	"#FFFFFF","#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
runPCAplotPlunge<-function(group, p1,p2,n1,n2){
scattercat1<-ggplot(speciesPCAvalues, aes_string(x = p1, y = p2, label = "Binomial")) +
theme_classic()+
xlab(label = paste0("p",as.character(p1),"(",
as.character(signif(d$percentexplained[n1], digits = 3)),
"%)"))+
ylab(label = paste0("p",as.character(p2),"(",
as.character(signif(d$percentexplained[n2], digits = 3)),
"%)"))+
#theme(legend.position = "none")+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$plungedistinct =="Plunging",],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$plungedistinct =="Terrestrial",],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$plungedistinct =="Surface",],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$plungedistinct =="Underwater pursuit",],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(aes_string(fill = group),s_shape=1, expand=0, color = "black", alpha = 0.7)+#s_shape = 1 and expan = 0 are convex hull
geom_point(aes_string(color = group), shape = 21, size = 3, color = "black")
#scale_color_manual(values = alpha(c("black","black","black","black","black","black",0.2))
scattercat1
}
runPCAplotPlunge("plungedistinct","PC1","PC2",1,2)
#plot by aquatic groupings
plunge<-runPCAplotPlunge("plungedistinct","PC1","PC2",1,2)+
geom_point(aes(fill = plungedistinct), size = 3, shape = 21, col = "black")+
scale_fill_manual(values = cbbPalette)+
theme(legend.position = "right")+
geom_text(aes(label = Binomial2))+
geom_text(aes(label = Binomial0))
plunge
divecol<-c("white",sequential_hcl(6, palette = "Purple-Blue",rev = T)[2:6])
speciesPCAvalues$divescore <- fct_explicit_na(speciesPCAvalues$divescore)
runPCAplotdive<-function(group, p1,p2,n1,n2){
scattercat1<-ggplot(speciesPCAvalues, aes_string(x = p1, y = p2, label = "Binomial")) +
theme_classic()+
xlab(label = paste0("p",as.character(p1),"(",
as.character(signif(d$percentexplained[n1], digits = 3)),
"%)"))+
ylab(label = paste0("p",as.character(p2),"(",
as.character(signif(d$percentexplained[n2], digits = 3)),
"%)"))+
#theme(legend.position = "none")+
geom_encircle(data = speciesPCAvalues[which(is.na(speciesPCAvalues$divescore)),],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==0,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==1,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==2,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==3,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==4,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(aes_string(fill = group),s_shape=1, expand=0, color = "black", alpha = 0.7)+#s_shape = 1 and expan = 0 are convex hull
geom_point(aes_string(color = group), shape = 21, size = 3, color = "black")
#scale_color_manual(values = alpha(c("black","black","black","black","black","black",0.2))
scattercat1
}
runPCAplotdive("divescore","PC1","PC2",1,2)
divescore<-runPCAplotdive("divescore","PC1","PC2",1,2)+
geom_point(aes(fill = divescore), size = 3, shape = 21,col = "black", alpha = 1)+
scale_fill_manual(values = divecol)+
#scale_alpha_manual(values = c(-.5,1,0,0,56))
theme(legend.position = "right")
divescore
#mypal <- colorRampPalette(rev(brewer.pal(6, "Blues")))
sequential_hcl(5, palette = "Purple-Blue", rev = T)
BLUE<-c("white","#d0d1e6",
"#a6bddb",
"#74a9cf",
"#2b8cbe",
"#045a8d")
divecol<-c("white",sequential_hcl(6, palette = "Purple-Blue",rev = T)[2:6])
divecol
runPCAplotdive<-function(group, p1,p2,n1,n2){
scattercat1<-ggplot(speciesPCAvalues, aes_string(x = p1, y = p2, label = "Binomial")) +
theme_classic()+
xlab(label = paste0("p",as.character(p1),"(",
as.character(signif(d$percentexplained[n1], digits = 3)),
"%)"))+
ylab(label = paste0("p",as.character(p2),"(",
as.character(signif(d$percentexplained[n2], digits = 3)),
"%)"))+
#theme(legend.position = "none")+
geom_encircle(data = speciesPCAvalues[which(is.na(speciesPCAvalues$divescore)),],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==0,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==1,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==2,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==3,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==4,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(aes_string(fill = group),s_shape=1, expand=0, color = "black", alpha = 0.7)+#s_shape = 1 and expan = 0 are convex hull
geom_point(aes_string(color = group), shape = 21, size = 3, color = "black")
#scale_color_manual(values = alpha(c("black","black","black","black","black","black",0.2))
scattercat1
}
runPCAplotdive("divescore","PC1","PC2",1,2)
divescore<-runPCAplotdive("divescore","PC1","PC2",1,2)+
geom_point(aes(fill = divescore), size = 3, shape = 21,col = "black", alpha = 1)+
scale_fill_manual(values = divecol)+
#scale_alpha_manual(values = c(-.5,1,0,0,56))
theme(legend.position = "right")
divescore
runPCAplotdive("divescore","PC1","PC2",1,2)
divecol<-c(sequential_hcl(6, palette = "Purple-Blue",rev = T)[2:6],"white")
divescore<-runPCAplotdive("divescore","PC1","PC2",1,2)+
geom_point(aes(fill = divescore), size = 3, shape = 21,col = "black", alpha = 1)+
scale_fill_manual(values = divecol)+
#scale_alpha_manual(values = c(-.5,1,0,0,56))
theme(legend.position = "right")
divescore
runPCAplotdive<-function(group, p1,p2,n1,n2){
scattercat1<-ggplot(speciesPCAvalues, aes_string(x = p1, y = p2, label = "Binomial")) +
theme_classic()+
xlab(label = paste0("p",as.character(p1),"(",
as.character(signif(d$percentexplained[n1], digits = 3)),
"%)"))+
ylab(label = paste0("p",as.character(p2),"(",
as.character(signif(d$percentexplained[n2], digits = 3)),
"%)"))+
#theme(legend.position = "none")+
geom_encircle(data = speciesPCAvalues[which(is.na(speciesPCAvalues$divescore)),],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==0,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==1,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==2,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==3,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==4,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(aes_string(fill = group),s_shape=1, expand=0, color = "black", alpha = 0.7)+#s_shape = 1 and expan = 0 are convex hull
geom_point(aes_string(color = group), shape = 21, size = 3, color = "black")
#scale_color_manual(values = alpha(c("black","black","black","black","black","black",0.2))
scattercat1
}
runPCAplotdive("divescore","PC1","PC2",1,2)
divescore<-runPCAplotdive("divescore","PC1","PC2",1,2)+
geom_point(aes(fill = divescore), size = 3, shape = 21,col = "black", alpha = 1)+
scale_fill_manual(values = divecol)+
#scale_alpha_manual(values = c(-.5,1,0,0,56))
theme(legend.position = "right")
divescore
runPCAplotdive("divescore","PC1","PC2",1,2)
runPCAplotdive<-function(group, p1,p2,n1,n2){
scattercat1<-ggplot(speciesPCAvalues, aes_string(x = p1, y = p2, label = "Binomial")) +
theme_classic()+
xlab(label = paste0("p",as.character(p1),"(",
as.character(signif(d$percentexplained[n1], digits = 3)),
"%)"))+
ylab(label = paste0("p",as.character(p2),"(",
as.character(signif(d$percentexplained[n2], digits = 3)),
"%)"))+
#theme(legend.position = "none")+
geom_encircle(data = speciesPCAvalues[which(is.na(speciesPCAvalues$divescore)),],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==0,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==1,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==2,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==3,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==4,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(aes_string(fill = group),s_shape=1, expand=0, color = "black", alpha = 0.7)+#s_shape = 1 and expan = 0 are convex hull
#geom_point(aes_string(color = group), shape = 21, size = 3, color = "black")
#scale_color_manual(values = alpha(c("black","black","black","black","black","black",0.2))
scattercat1
}
runPCAplotdive("divescore","PC1","PC2",1,2)
runPCAplotdive<-function(group, p1,p2,n1,n2){
scattercat1<-ggplot(speciesPCAvalues, aes_string(x = p1, y = p2, label = "Binomial")) +
theme_classic()+
xlab(label = paste0("p",as.character(p1),"(",
as.character(signif(d$percentexplained[n1], digits = 3)),
"%)"))+
ylab(label = paste0("p",as.character(p2),"(",
as.character(signif(d$percentexplained[n2], digits = 3)),
"%)"))+
#theme(legend.position = "none")+
geom_encircle(data = speciesPCAvalues[which(is.na(speciesPCAvalues$divescore)),],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==0,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==1,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==2,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==3,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==4,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(aes_string(fill = group),s_shape=1, expand=0, color = "black", alpha = 0.7)#s_shape = 1 and expan = 0 are convex hull
#geom_point(aes_string(color = group), shape = 21, size = 3, color = "black")
#scale_color_manual(values = alpha(c("black","black","black","black","black","black",0.2))
scattercat1
}
runPCAplotdive("divescore","PC1","PC2",1,2)
speciesPCAvalues$divescore <- fct_explicit_na(speciesPCAvalues$divescore)
speciesPCAvalues$divescore<-as.factor(dfwithresids[match(row.names(speciesPCAvalues),
dfwithresids$Binomial),"divescore"])#<-------------<-------
speciesPCAvalues$plungedistinct<-as.factor(dfwithresids[match(row.names(speciesPCAvalues),
dfwithresids$Binomial),"plungedistinct"])#<-------------<-------
divecol<-c(sequential_hcl(6, palette = "Purple-Blue",rev = T)[2:6],"white")
runPCAplotdive<-function(group, p1,p2,n1,n2){
scattercat1<-ggplot(speciesPCAvalues, aes_string(x = p1, y = p2, label = "Binomial")) +
theme_classic()+
xlab(label = paste0("p",as.character(p1),"(",
as.character(signif(d$percentexplained[n1], digits = 3)),
"%)"))+
ylab(label = paste0("p",as.character(p2),"(",
as.character(signif(d$percentexplained[n2], digits = 3)),
"%)"))+
#theme(legend.position = "none")+
geom_encircle(data = speciesPCAvalues[which(is.na(speciesPCAvalues$divescore)),],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==0,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==1,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==2,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==3,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==4,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(aes_string(fill = group),s_shape=1, expand=0, color = "black", alpha = 0.7)#s_shape = 1 and expan = 0 are convex hull
#geom_point(aes_string(color = group), shape = 21, size = 3, color = "black")
#scale_color_manual(values = alpha(c("black","black","black","black","black","black",0.2))
scattercat1
}
runPCAplotdive("divescore","PC1","PC2",1,2)
runPCAplotdive<-function(group, p1,p2,n1,n2){
scattercat1<-ggplot(speciesPCAvalues, aes_string(x = p1, y = p2, label = "Binomial")) +
theme_classic()+
xlab(label = paste0("p",as.character(p1),"(",
as.character(signif(d$percentexplained[n1], digits = 3)),
"%)"))+
ylab(label = paste0("p",as.character(p2),"(",
as.character(signif(d$percentexplained[n2], digits = 3)),
"%)"))+
#theme(legend.position = "none")+
geom_encircle(data = speciesPCAvalues[which(is.na(speciesPCAvalues$divescore)),],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==0,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==1,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==2,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==3,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==4,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(aes_string(fill = group),s_shape=1, expand=0, color = "black", alpha = 0.7)+#s_shape = 1 and expan = 0 are convex hull
geom_point(aes_string(color = group), shape = 21, size = 3, color = "black")
#scale_color_manual(values = alpha(c("black","black","black","black","black","black",0.2))
scattercat1
}
runPCAplotdive("divescore","PC1","PC2",1,2)
runPCAplotdive("divescore","PC1","PC2",1,2)
which(is.na(speciesPCAvalues$divescore))
speciesPCAvalues[which(is.na(speciesPCAvalues$divescore)),]
str(speciesPCAvalues$divescore)
levels(speciesPCAvalues)
levels(speciesPCAvalues$divescore)
divecol<-c(sequential_hcl(6, palette = "Purple-Blue",rev = T)[2:6],"white")
speciesPCAvalues$divescore <- fct_explicit_na(speciesPCAvalues$divescore)
runPCAplotdive<-function(group, p1,p2,n1,n2){
scattercat1<-ggplot(speciesPCAvalues, aes_string(x = p1, y = p2, label = "Binomial")) +
theme_classic()+
xlab(label = paste0("p",as.character(p1),"(",
as.character(signif(d$percentexplained[n1], digits = 3)),
"%)"))+
ylab(label = paste0("p",as.character(p2),"(",
as.character(signif(d$percentexplained[n2], digits = 3)),
"%)"))+
#theme(legend.position = "none")+
geom_encircle(data = speciesPCAvalues[which(is.na(speciesPCAvalues$divescore)),],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==0,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==1,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==2,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==3,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==4,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(aes_string(fill = group),s_shape=1, expand=0, color = "black", alpha = 0.7)+#s_shape = 1 and expan = 0 are convex hull
geom_point(aes_string(color = group), shape = 21, size = 3, color = "black")
#scale_color_manual(values = alpha(c("black","black","black","black","black","black",0.2))
scattercat1
}
runPCAplotdive("divescore","PC1","PC2",1,2)
divescore<-runPCAplotdive("divescore","PC1","PC2",1,2)+
geom_point(aes(fill = divescore), size = 3, shape = 21,col = "black", alpha = 1)+
scale_fill_manual(values = divecol)+
#scale_alpha_manual(values = c(-.5,1,0,0,56))
theme(legend.position = "right")
divescore
runPCAplotdive<-function(group, p1,p2,n1,n2){
scattercat1<-ggplot(speciesPCAvalues, aes_string(x = p1, y = p2, label = "Binomial")) +
theme_classic()+
xlab(label = paste0("p",as.character(p1),"(",
as.character(signif(d$percentexplained[n1], digits = 3)),
"%)"))+
ylab(label = paste0("p",as.character(p2),"(",
as.character(signif(d$percentexplained[n2], digits = 3)),
"%)"))+
#theme(legend.position = "none")+
geom_encircle(data = speciesPCAvalues[which(is.na(speciesPCAvalues$divescore)),],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==0,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==1,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==2,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==3,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==4,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(aes_string(fill = group),s_shape=1, expand=0, color = "black", alpha = 0.7)+#s_shape = 1 and expan = 0 are convex hull
geom_point(aes_string(color = group), shape = 21, size = 3, color = "black")+
scale_color_manual(values = alpha(c("black","black","black","black","black","black",0.2))
scattercat1
}
runPCAplotdive("divescore","PC1","PC2",1,2)
divescore<-runPCAplotdive("divescore","PC1","PC2",1,2)+
geom_point(aes(fill = divescore), size = 3, shape = 21,col = "black", alpha = 1)+
scale_fill_manual(values = divecol)+
#scale_alpha_manual(values = c(-.5,1,0,0,56))
theme(legend.position = "right")
divescore
pPCAloadings$factor<-row.names(pPCAloadings)
pPCAloadings$factor<-gsub("RES_log"," ",pPCAloadings$factor)
pPCAloadings$factor<-gsub("logHeadmassg","",pPCAloadings$factor)
loadings1<-ggplot(pPCAloadings, aes(x = PC1, y = PC2, label =factor)) +
xlab(label = "pPC1")+
ylab(label = "pPC2")+
#geom_point(aes(), size = 0.005) +
#geom_point(data = pPCAloadings)+
geom_text_repel(aes()) +
theme_classic()+
xlim(-1.5,+1)+
ylim(-1,1)+
geom_segment(aes(x = 0, y = 0,xend = PC1, yend = PC2), arrow = arrow(type = "closed", length = unit(0.10,"inches")))+
theme(legend.position = "bottom")
loadings1
ggarrange(loadings1,plunge,divescore, order,labels = c("A","B","C","D"))
levels(speciesPCAvalues$divescore)
speciesPCAvalues$divescore <- fct_explicit_na(speciesPCAvalues$divescore)
relevel(speciesPCAvalues$divescore,c(       "(Missing)","0",         "1",         "2" ,        "3",         "4"  ))
?relevel
<-reorder(speciesPCAvalues$divescore,c(       "(Missing)","0",         "1",         "2" ,        "3",         "4"  ))
reorder(speciesPCAvalues$divescore,c(       "(Missing)","0",         "1",         "2" ,        "3",         "4"  ))
c(       "(Missing)","0",         "1",         "2" ,        "3",         "4"  )
reorder(speciesPCAvalues$divescore,c(       "(Missing)","0",         "1",         "2" ,        "3",         "4"  ))
levels(speciesPCAvalues$divescore)
reorder(speciesPCAvalues$divescore,
c( "(Missing)","0", "1","2" ,   "3",  "4"  ))
relv<-c( "(Missing)","0", "1","2" ,   "3",  "4"  )
speciesPCAvalues$divescore<-reorder(speciesPCAvalues$divescore,relv)
divescore
speciesPCAvalues$divescore<-relevel(speciesPCAvalues$divescore,ref = "(Missing)")
runPCAplotdive<-function(group, p1,p2,n1,n2){
scattercat1<-ggplot(speciesPCAvalues, aes_string(x = p1, y = p2, label = "Binomial")) +
theme_classic()+
xlab(label = paste0("p",as.character(p1),"(",
as.character(signif(d$percentexplained[n1], digits = 3)),
"%)"))+
ylab(label = paste0("p",as.character(p2),"(",
as.character(signif(d$percentexplained[n2], digits = 3)),
"%)"))+
#theme(legend.position = "none")+
geom_encircle(data = speciesPCAvalues[which(is.na(speciesPCAvalues$divescore)),],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==0,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==1,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==2,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==3,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==4,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(aes_string(fill = group),s_shape=1, expand=0, color = "black", alpha = 0.7)+#s_shape = 1 and expan = 0 are convex hull
geom_point(aes_string(color = group), shape = 21, size = 3, color = "black")+
scale_color_manual(values = alpha(c("black","black","black","black","black","black",0.2))
scattercat1
}
runPCAplotdive("divescore","PC1","PC2",1,2)
divescore<-runPCAplotdive("divescore","PC1","PC2",1,2)+
geom_point(aes(fill = divescore), size = 3, shape = 21,col = "black", alpha = 1)+
scale_fill_manual(values = divecol)+
#scale_alpha_manual(values = c(-.5,1,0,0,56))
theme(legend.position = "right")
divescore
divecol<-c("white",sequential_hcl(6, palette = "Purple-Blue",rev = T)[2:6])
runPCAplotdive<-function(group, p1,p2,n1,n2){
scattercat1<-ggplot(speciesPCAvalues, aes_string(x = p1, y = p2, label = "Binomial")) +
theme_classic()+
xlab(label = paste0("p",as.character(p1),"(",
as.character(signif(d$percentexplained[n1], digits = 3)),
"%)"))+
ylab(label = paste0("p",as.character(p2),"(",
as.character(signif(d$percentexplained[n2], digits = 3)),
"%)"))+
#theme(legend.position = "none")+
geom_encircle(data = speciesPCAvalues[which(is.na(speciesPCAvalues$divescore)),],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==0,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==1,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==2,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==3,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(data = speciesPCAvalues[speciesPCAvalues$divescore==4,],
aes_string(),s_shape=1, expand=0, alpha = 1)+
geom_encircle(aes_string(fill = group),s_shape=1, expand=0, color = "black", alpha = 0.7)+#s_shape = 1 and expan = 0 are convex hull
geom_point(aes_string(color = group), shape = 21, size = 3, color = "black")+
scale_color_manual(values = alpha(c("black","black","black","black","black","black",0.2))
scattercat1
}
runPCAplotdive("divescore","PC1","PC2",1,2)
divescore<-runPCAplotdive("divescore","PC1","PC2",1,2)+
geom_point(aes(fill = divescore), size = 3, shape = 21,col = "black", alpha = 1)+
scale_fill_manual(values = divecol)+
#scale_alpha_manual(values = c(-.5,1,0,0,56))
theme(legend.position = "right")
divescore
